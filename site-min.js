function AnagramSolver(t){"use strict";function e(t){this.score=null,this.data=t,this.childs=0,this.children={},this.setData=function(t){this.score=t}}this.tree=new function(){this.root=new e(null,null);var t={a:1,b:4,c:4,d:2,e:1,f:4,g:3,h:3,i:1,j:10,k:5,l:2,m:4,n:2,o:1,p:4,q:10,r:1,s:1,t:1,u:2,v:5,w:4,x:8,y:3,z:10};this.addKey=function(n){for(var a=this.root,r=n.split(""),o=0,i="",c=0;c<r.length;c++)/[&\^%4#!@\*\)\(\}\{\[\]\\\|/><-_=\~`+?]/.test(r[c])||(i+=r[c],void 0===a.children[r[c]]&&(a.children[r[c]]=new e(i),a.childs++),a=a.children[r[c]],o+=t[r[c]]);a.setData(o)},this.lookup=function(t,e){for(var n=void 0===e||null===e?this.root:e,a=t.toLowerCase().split(""),r=0;r<a.length;r++){if(void 0===n.children[a[r]])return-1;n=n.children[a[r]]}return n}};var n=t.split(/[?\s,\.]/);for(var a in n)this.tree.addKey(n[a]);this.makeAnagrams=function(t){var e=this.tree,n=new Array,a={},r=new Array;r[0]=new Array;for(var o=t.split(""),i=0;i<o.length;i++)r[0].push(e.lookup(o[i]));for(var c=1;c<o.length;c++)!function(i){r[i]=new Array;for(var c=0;c<r[i-1].length;c++)for(var l=0;l<o.length;l++)if((o[l]+r[i-1][c].data).match(new RegExp(o[l],"g")).length<=t.match(new RegExp(o[l],"g")).length){var u=e.lookup(o[l],r[i-1][c]);-1!==u&&(u.childs>0&&r[i].push(u),null!==u.score&&void 0===a[u.data]&&(a[u.data]=0,n.push(u)))}}(c);return n=n.sort(function(t,e){return t.score>e.score?-1:t.score<e.score?1:t.score===e.score?0:void 0})}}function init(t){anagram=new AnagramSolver(t),loading(!1)}function combos(t){t=t.split("").sort().join("");var e=[],n=[];return letters.forEach(function(n){e.push(t.replace(/\?/,n))}),e.forEach(function(t){t.indexOf("?")>-1?letters.forEach(function(e){n.push(t.replace(/\?/,e))}):n.push(t)}),n}function loading(t,e){t?(document.body.setAttribute("data-loading",!0),document.querySelector(".loader").setAttribute("data-active",!0),document.querySelector(".loader span").textContent=e):(document.body.removeAttribute("data-loading"),document.querySelector(".loader").removeAttribute("data-active"),document.querySelector(".loader span").textContent="")}function getResults(){var t=document.querySelector("input").value,e=[];t.match(/\?/)?combos(t).forEach(function(t){e=e.concat(anagram.makeAnagrams(t))}):e=anagram.makeAnagrams(t),e.sort(function(t,e){return e.data.length-t.data.length||t.data.localeCompare(e.data)});var n=[],a="",r=0;e.filter(function(t){return-1===n.indexOf(t)&&(n.push(t),!0)}).forEach(function(t){r!=t.data.length&&(a+='</div><div class="card"><h2 class="word-header" data-text="'+t.data.length+'">'+t.data.length+" Letters</h2>"),a+='<div class="word">'+t.data+"</div>",r=t.data.length}),document.querySelector("#results").innerHTML="<div class=''card'>"+a+"</div>"}var letters=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],anagram;loading(!0,"Loading dictionary"),window.localStorage.dict?init(window.localStorage.dict):fetch("words.txt").then(function(t){return t.text().then(function(t){window.localStorage.dict=t,init(t)})}),document.querySelector("form").onsubmit=function(t){t.preventDefault(),loading(!0,"Fetching words"),document.querySelector("#results").innerHTML="",setTimeout(function(){getResults()},50)},document.querySelector("input").onkeyup=function(t){if(this.value.match(/^[a-z?]+$/gi)||(this.value=this.value.replace(t.key,"")),this.value.match(/\?/g)&&3===this.value.match(/\?/g).length){var e=this.value.lastIndexOf("?");this.value=this.value.replace(/\?/g,function(t,n){return n===e?"":t})}},document.addEventListener("animationstart",function(t){console.log("trigger"),loading(!1)});